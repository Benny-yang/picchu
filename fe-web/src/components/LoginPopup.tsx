import React from 'react';
import TermsModal from './TermsModal';
import PrivacyModal from './PrivacyModal';
import { X } from 'lucide-react';

interface LoginPopupProps {
    onClose?: () => void;
    onLogin?: () => void;
    onRegister?: () => void;
}

const LoginPopup: React.FC<LoginPopupProps> = ({ onLogin, onRegister, onClose }) => {
    const [showTerms, setShowTerms] = React.useState(false);
    const [showPrivacy, setShowPrivacy] = React.useState(false);

    return (
        <div className="fixed inset-0 z-50 flex items-center justify-center font-sans">
            {/* Background Overlay */}
            <div
                className="absolute inset-0 bg-[#191919]/50 transition-opacity"
                onClick={onClose}
            />

            {/* Modal Card - Exact Dimensions from Figma */}
            <div className="relative w-[616px] h-[536px] bg-white rounded-[16px] flex flex-col items-center shadow-xl animate-fade-in-up">

                {/* Close Button - Positioned top right */}
                <button
                    onClick={onClose}
                    className="absolute top-6 right-6 text-[#191919] hover:text-gray-600 transition-colors"
                >
                    <X size={24} />
                </button>

                {/* Logo Section - Top Center */}
                {/* Position guessed based on layout. Logo roughly centered above buttons. */}
                <div className="flex flex-col items-center mt-[80px] mb-[60px]">
                    {/* Authentic Figma Logo (Icon + Text) */}
                    <div className="w-[160px] h-[178px] flex items-center justify-center mb-4">
                        <svg width="100%" height="100%" viewBox="0 0 160 178" fill="none" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet">
                            <path id="Union" fillRule="evenodd" clipRule="evenodd" d="M138.838 48.8421C138.84 51.2636 138.685 53.6826 138.375 56.0842C138.5 56.7328 138.409 57.4046 138.114 57.9958C136.554 68.1869 131.492 77.5161 123.798 84.379C115.183 92.059 103.259 96.4632 91.0909 96.4632H75.6888V106.484C75.6888 118.425 67.3435 127.091 55.8403 127.091C53.1366 127.108 50.4567 126.585 47.9573 125.554C45.458 124.522 43.1896 123.003 41.2848 121.084C39.38 119.165 37.8772 116.885 36.8642 114.378C35.8513 111.871 35.3486 109.188 35.3856 106.484V49.6168C35.2208 49.0675 35.2208 48.4819 35.3856 47.9326V30.3158C35.3856 22.2755 38.5796 14.5646 44.2649 8.87929C49.9502 3.19398 57.6611 0 65.7014 0H91.0909C114.089 0 138.838 15.3011 138.838 48.8421ZM91.0909 6.06316H65.7014C59.2712 6.06985 53.1064 8.62717 48.5596 13.174C44.0128 17.7208 41.4554 23.8856 41.4488 30.3158V48C43.5203 50.7284 50.6109 59.04 60.674 60.2526C68.1267 61.2042 75.8488 58.0632 83.6046 50.9895C91.8319 43.4105 100.716 39.8737 110.063 40.4126C119.916 40.9853 127.975 46.0632 132.8 49.9958V48.8421C132.8 28.2442 119.722 6.06316 91.0909 6.06316ZM72.6909 90.4H91.0909C109.508 90.4 128.143 79.1158 131.983 57.4484C129.045 54.5516 120.438 47.0484 109.567 46.4421C101.988 46.0042 94.6361 49.0358 87.6719 55.4105C79.6382 62.7705 71.4361 66.4842 63.2509 66.4842C62.1249 66.4806 61.0001 66.4103 59.8824 66.2737C51.8825 65.3053 45.6172 60.8926 41.4488 56.9937V106.484C41.4488 113.642 46.8382 121.053 55.8656 121.053C63.9919 121.053 69.6761 115.057 69.6761 106.484V93.4232C69.675 93.0266 69.7522 92.6336 69.9032 92.2669C70.0542 91.9001 70.2761 91.5668 70.5561 91.286C70.8362 91.0051 71.1689 90.7823 71.5352 90.6303C71.9015 90.4783 72.2943 90.4 72.6909 90.4ZM94.7372 170.467C94.4068 170.419 94.0701 170.438 93.7473 170.523C93.4245 170.609 93.1224 170.759 92.8593 170.964C91.4788 172.3 89.6428 173.061 87.7224 173.095C82.2151 173.095 80.2614 168.884 80.2614 165.297C80.2614 161.71 82.2151 157.718 87.7224 157.718C88.566 157.653 89.4132 157.78 90.2007 158.089C90.9882 158.399 91.6956 158.882 92.2698 159.503C92.7422 159.965 93.371 160.231 94.0311 160.25C94.6912 160.269 95.3341 160.038 95.8319 159.604C96.0749 159.358 96.2645 159.064 96.3891 158.741C96.5137 158.417 96.5705 158.072 96.5561 157.726C96.5473 157.374 96.4683 157.028 96.3237 156.707C96.179 156.386 95.9718 156.097 95.714 155.857C93.5551 153.823 90.6881 152.711 87.7224 152.758C79.2593 152.758 75.4698 159.048 75.4698 165.28C75.4698 174.493 81.794 177.768 87.7224 177.768C90.1982 177.768 93.3814 177.457 96.0003 175.023C96.5121 174.587 96.8387 173.973 96.9138 173.305C96.9889 172.637 96.8068 171.966 96.4045 171.427C95.9924 170.905 95.3955 170.562 94.7372 170.467ZM62.9768 170.523C63.2995 170.438 63.6363 170.419 63.9667 170.467C64.6371 170.554 65.2475 170.898 65.6677 171.427C66.07 171.966 66.2521 172.637 66.177 173.305C66.1019 173.973 65.7753 174.587 65.2635 175.023C62.6446 177.457 59.5035 177.768 56.9772 177.768C51.0572 177.768 44.733 174.493 44.733 165.28C44.733 159.048 48.5561 152.758 56.9772 152.758C59.9453 152.712 62.8147 153.823 64.9772 155.857C65.2349 156.097 65.4422 156.386 65.5868 156.707C65.7314 157.028 65.8105 157.374 65.8193 157.726C65.8337 158.072 65.7768 158.418 65.6523 158.741C65.5277 159.064 65.338 159.358 65.0951 159.604C64.5973 160.038 63.9544 160.269 63.2943 160.25C62.6342 160.231 62.0054 159.965 61.533 159.503C60.9571 158.882 60.2482 158.398 59.4594 158.089C58.6705 157.78 57.822 157.653 56.9772 157.718C51.4782 157.718 49.5246 161.71 49.5246 165.297C49.5246 168.884 51.4782 173.095 56.9772 173.095C58.8888 173.055 60.7146 172.294 62.0888 170.964C62.3519 170.759 62.654 170.609 62.9768 170.523ZM10.4845 153.044H2.61929C1.92093 153.051 1.25356 153.334 0.762888 153.831C0.272215 154.328 -0.00191618 154.999 0.000339843 155.697V174.863C-0.00526052 175.21 0.0584066 175.555 0.187616 175.877C0.316826 176.199 0.508984 176.492 0.752848 176.739C0.996713 176.986 1.28739 177.182 1.60786 177.316C1.92834 177.449 2.27219 177.517 2.61929 177.516C2.96202 177.523 3.30243 177.458 3.61837 177.325C3.9343 177.192 4.21869 176.994 4.45302 176.744C4.68735 176.493 4.86637 176.197 4.97845 175.873C5.09052 175.549 5.13313 175.205 5.1035 174.863V170.653H10.4845C16.4719 170.653 19.1919 166.156 19.1919 161.979C19.1919 157.684 16.4719 153.044 10.4845 153.044ZM10.4845 165.811H5.1035V157.937H10.4845C11.4972 157.984 12.4528 158.419 13.1528 159.152C13.8529 159.885 14.2435 160.86 14.2435 161.874C14.2435 162.887 13.8529 163.862 13.1528 164.595C12.4528 165.329 11.4972 165.764 10.4845 165.811ZM31.8235 153.263C31.4921 153.244 31.1601 153.292 30.8481 153.406C30.5362 153.519 30.2507 153.695 30.0093 153.923C29.7679 154.151 29.5758 154.426 29.4446 154.731C29.3134 155.036 29.2461 155.365 29.2467 155.697V175.133C29.2367 175.464 29.2958 175.793 29.4203 176.1C29.5447 176.407 29.7317 176.684 29.9694 176.915C30.2071 177.146 30.4903 177.324 30.8008 177.439C31.1113 177.554 31.4424 177.603 31.773 177.583C32.1014 177.595 32.4287 177.539 32.7354 177.421C33.042 177.303 33.3217 177.124 33.5575 176.895C33.7934 176.667 33.9807 176.393 34.1082 176.097C34.2356 175.787 34.3006 175.461 34.2993 175.133V155.697C34.3077 155.371 34.249 155.048 34.127 154.746C34.005 154.444 33.8223 154.17 33.5901 153.942C33.3579 153.714 33.0812 153.536 32.7773 153.419C32.4734 153.302 32.1488 153.249 31.8235 153.263ZM123.565 154.024C124.053 153.573 124.7 153.333 125.365 153.356C125.683 153.348 126.001 153.405 126.297 153.523C126.593 153.641 126.862 153.818 127.088 154.043C127.314 154.268 127.492 154.537 127.611 154.832C127.73 155.128 127.788 155.445 127.781 155.764V175.133C127.785 175.451 127.725 175.767 127.604 176.062C127.484 176.356 127.306 176.624 127.081 176.849C126.856 177.074 126.588 177.252 126.293 177.372C125.999 177.493 125.683 177.553 125.365 177.55C124.699 177.572 124.051 177.331 123.562 176.879C123.073 176.426 122.783 175.798 122.754 175.133V167.983H112.261V175.133C112.271 175.45 112.215 175.765 112.099 176.06C111.983 176.356 111.809 176.624 111.586 176.85C111.363 177.076 111.097 177.254 110.804 177.374C110.51 177.495 110.195 177.554 109.878 177.55C108.253 177.55 107.158 176.581 107.158 175.133V155.764C107.158 154.324 108.253 153.356 109.878 153.356C110.195 153.35 110.51 153.409 110.803 153.528C111.096 153.647 111.363 153.825 111.585 154.05C111.808 154.275 111.983 154.543 112.099 154.838C112.215 155.132 112.271 155.448 112.261 155.764V162.888H122.754V155.764C122.785 155.1 123.076 154.475 123.565 154.024ZM159.049 153.903C158.594 153.473 157.991 153.235 157.365 153.238C157.017 153.234 156.672 153.301 156.351 153.434C156.03 153.568 155.739 153.764 155.496 154.013C155.252 154.262 155.062 154.557 154.936 154.881C154.81 155.205 154.751 155.551 154.762 155.899V168.227C154.783 168.928 154.642 169.623 154.35 170.26C154.057 170.897 153.622 171.458 153.078 171.899C152.009 172.708 150.697 173.132 149.356 173.103C146.56 173.103 143.731 171.419 143.731 168.227V155.899C143.745 155.532 143.683 155.165 143.548 154.823C143.413 154.481 143.209 154.17 142.948 153.912C142.491 153.484 141.889 153.246 141.264 153.246C140.917 153.24 140.574 153.305 140.254 153.437C139.934 153.57 139.644 153.766 139.403 154.015C139.162 154.264 138.975 154.559 138.853 154.883C138.732 155.207 138.678 155.553 138.695 155.899V168.227C138.695 172.968 142.005 178.08 149.264 178.08C156.522 178.08 159.832 172.968 159.832 168.227V155.899C159.845 155.53 159.782 155.163 159.647 154.82C159.513 154.477 159.309 154.165 159.049 153.903Z" fill="url(#paint0_linear_3728_4633)" />
                            <defs>
                                <linearGradient id="paint0_linear_3728_4633" x1="14.2124" y1="136.947" x2="147.617" y2="58.5789" gradientUnits="userSpaceOnUse">
                                    <stop stopColor="#FFAF3C" />
                                    <stop offset="0.5" stopColor="#73AA8C" />
                                    <stop offset="1" stopColor="#009BCD" />
                                </linearGradient>
                            </defs>
                        </svg>
                    </div>
                </div>

                {/* Action Buttons - Centered Row */}
                {/* Figma: items-center left-1/2 top-[356px] */}
                <div className="absolute top-[356px] w-full flex justify-center gap-[40px]">
                    {/* Register Button - Solid Blue (#009bcd) */}
                    {/* Figma: px-[32px] py-[8px] rounded-[50px] */}
                    <button
                        onClick={onRegister}
                        className="px-[32px] py-[8px] rounded-[50px] bg-[#009bcd] text-white font-bold text-[16px] leading-[1.4] hover:bg-[#0089b6] transition-colors min-w-[120px]"
                    >
                        註冊
                    </button>

                    {/* Login Button - Gradient */}
                    <button
                        onClick={onLogin}
                        className="px-[32px] py-[8px] rounded-[50px] bg-gradient-to-r from-[#F2994A] to-[#009bcd] text-white font-bold text-[16px] leading-[1.4] hover:opacity-90 transition-opacity min-w-[120px]"
                    >
                        登入
                    </button>
                </div>

                {/* Footer Text */}
                {/* Figma: top-[430px] */}
                <div className="absolute top-[430px] w-full text-center">
                    <p className="text-[14px] text-[#191919] font-normal leading-[1.5]">
                        點擊註冊，即表示你同意
                        <span className="mx-1"></span>
                        <button
                            className="text-[#009bcd] hover:underline font-normal transition-colors"
                            onClick={() => setShowTerms(true)}
                        >
                            服務條款
                        </button>
                        <span className="mx-1">及</span>
                        <button
                            className="text-[#009bcd] hover:underline font-normal transition-colors"
                            onClick={() => setShowPrivacy(true)}
                        >
                            隱私權條款
                        </button>
                    </p>
                </div>
            </div>

            {/* Terms Modal */}
            <TermsModal
                isOpen={showTerms}
                onClose={() => setShowTerms(false)}
            />

            {/* Privacy Modal */}
            <PrivacyModal
                isOpen={showPrivacy}
                onClose={() => setShowPrivacy(false)}
            />
        </div>
    );
};

export default LoginPopup;
